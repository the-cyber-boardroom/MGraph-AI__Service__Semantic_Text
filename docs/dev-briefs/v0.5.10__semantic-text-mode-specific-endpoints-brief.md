# Technical Brief: Mode-Specific Transformation Endpoints
## Semantic Text Service Enhancement

**Version:** v0.5.10  
**Date:** 2025-11-07  
**Target Service:** MGraph-AI Semantic_Text Service  
**Enhancement Type:** API Convenience Methods

---

## Executive Summary

This brief defines the addition of mode-specific transformation endpoints to complement the existing generic `/text-transformation/transform` endpoint. These new endpoints provide convenience wrappers that simplify testing, improve developer experience, and enhance API discoverability.

**Key Principles:**
- Thin wrappers around existing `Text__Transformation__Service`
- No new business logic - pure API convenience layer
- Maintain full backward compatibility with existing endpoint
- Follow Type_Safe patterns for all new schemas
- Comprehensive testing for each new endpoint

---

## Part 1: Current State Analysis

### 1.1 Existing Endpoint

**Current Implementation:**
```
POST /text-transformation/transform
```

**Request Schema:**
```python
class Schema__Text__Transformation__Request(Type_Safe):
    hash_mapping            : Dict[Safe_Str__Hash, str]
    transformation_mode     : Enum__Text__Transformation__Mode      # Client must specify mode
    randomness_percentage   : Safe_Float = 0.5
```

**Usage Example:**
```json
{
  "hash_mapping": {
    "abc123": "Hello World",
    "def456": "Test message"
  },
  "transformation_mode": "xxx-random",
  "randomness_percentage": 0.5
}
```

### 1.2 Pain Points

**Testing Complexity:**
- Must construct full request object for each test
- Mode parameter adds extra setup in tests
- Verbose for simple single-mode testing

**Developer Experience:**
- Generic endpoint requires knowing mode strings
- No mode-specific parameter documentation
- Less discoverable in OpenAPI docs

**Example Test (Current):**
```python
def test_xxx_random():
    request = Schema__Text__Transformation__Request(
        hash_mapping={"abc": "test"},
        transformation_mode=Enum__Text__Transformation__Mode.XXX_RANDOM,
        randomness_percentage=0.5
    )
    response = client.post("/text-transformation/transform", json=request.obj())
    # Assertions...
```

**Desired Test (After Enhancement):**
```python
def test_xxx_random():
    response = client.post("/text-transformation/xxx-random", json={
        "hash_mapping": {"abc": "test"},
        "randomness_percentage": 0.5
    })
    # Assertions...
```

---

## Part 2: Proposed Solution

### 2.1 New Endpoint Structure

**Add Three Mode-Specific Endpoints:**

```
POST /text-transformation/xxx-random          # xxx-random transformation
POST /text-transformation/hashes-random       # hashes-random transformation
POST /text-transformation/abcde-by-size       # abcde-by-size transformation
```

**Benefits:**
- ✅ Clearer intent - URL indicates transformation type
- ✅ Simpler payloads - no mode parameter needed
- ✅ Better OpenAPI docs - each mode gets dedicated documentation
- ✅ Easier testing - less boilerplate in tests
- ✅ Backward compatible - existing `/transform` endpoint unchanged

### 2.2 Architectural Pattern

**Design Principle:** Thin wrappers with no new business logic

```
Client Request
    ↓
Mode-Specific Endpoint (thin wrapper)
    ↓
Build Schema__Text__Transformation__Request with hardcoded mode
    ↓
Call existing Text__Transformation__Service.transform()
    ↓
Return response
```

**Implementation Strategy:**
1. Create mode-specific request schemas (without mode parameter)
2. Add new endpoint methods to `Routes__Text_Transformation`
3. Each endpoint constructs full request with hardcoded mode
4. Delegate to existing `self.service.transform()`
5. Return response unchanged

---

## Part 3: Schema Specifications

### 3.1 Base Request Schema (Keep Existing)

```python
# schemas/transformation/Schema__Text__Transformation__Request.py (UNCHANGED)

class Schema__Text__Transformation__Request(Type_Safe):
    hash_mapping            : Dict[Safe_Str__Hash, str]
    transformation_mode     : Enum__Text__Transformation__Mode
    randomness_percentage   : Safe_Float = 0.5
```

### 3.2 New Mode-Specific Request Schemas

**Create three new schemas without mode parameter:**

#### Schema__Text__Transformation__Request__XXX_Random

```python
# schemas/transformation/Schema__Text__Transformation__Request__XXX_Random.py

from typing                                                                      import Dict
from osbot_utils.type_safe.Type_Safe                                             import Type_Safe
from osbot_utils.type_safe.primitives.core.Safe_Float                            import Safe_Float
from osbot_utils.type_safe.primitives.domains.cryptography.safe_str.Safe_Str__Hash import Safe_Str__Hash


class Schema__Text__Transformation__Request__XXX_Random(Type_Safe):              # Request for xxx-random transformation
    hash_mapping            : Dict[Safe_Str__Hash, str]                          # Hash → original text mapping
    randomness_percentage   : Safe_Float                       = 0.5             # Percentage of hashes to transform (0.0-1.0)
```

#### Schema__Text__Transformation__Request__Hashes_Random

```python
# schemas/transformation/Schema__Text__Transformation__Request__Hashes_Random.py

from typing                                                                      import Dict
from osbot_utils.type_safe.Type_Safe                                             import Type_Safe
from osbot_utils.type_safe.primitives.core.Safe_Float                            import Safe_Float
from osbot_utils.type_safe.primitives.domains.cryptography.safe_str.Safe_Str__Hash import Safe_Str__Hash


class Schema__Text__Transformation__Request__Hashes_Random(Type_Safe):           # Request for hashes-random transformation
    hash_mapping            : Dict[Safe_Str__Hash, str]                          # Hash → original text mapping
    randomness_percentage   : Safe_Float                       = 0.5             # Percentage of hashes to transform (0.0-1.0)
```

#### Schema__Text__Transformation__Request__ABCDE_By_Size

```python
# schemas/transformation/Schema__Text__Transformation__Request__ABCDE_By_Size.py

from typing                                                                      import Dict
from osbot_utils.type_safe.Type_Safe                                             import Type_Safe
from osbot_utils.type_safe.primitives.core.Safe_Float                            import Safe_Float
from osbot_utils.type_safe.primitives.core.Safe_UInt                             import Safe_UInt
from osbot_utils.type_safe.primitives.domains.cryptography.safe_str.Safe_Str__Hash import Safe_Str__Hash


class Schema__Text__Transformation__Request__ABCDE_By_Size(Type_Safe):           # Request for abcde-by-size transformation
    hash_mapping            : Dict[Safe_Str__Hash, str]                          # Hash → original text mapping
    randomness_percentage   : Safe_Float                       = 0.5             # Percentage of hashes to transform (0.0-1.0)
    num_groups              : Safe_UInt                        = Safe_UInt(5)    # Number of groups (a,b,c,d,e by default)
```

**Note:** ABCDE mode includes `num_groups` parameter since it's specific to this transformation.

### 3.3 Response Schema (Use Existing)

All endpoints return the same response schema:

```python
# schemas/transformation/Schema__Text__Transformation__Response.py (UNCHANGED)

class Schema__Text__Transformation__Response(Type_Safe):
    transformed_mapping     : Dict[Safe_Str__Hash, str]
    transformation_mode     : Enum__Text__Transformation__Mode              # Mode applied
    success                 : bool
    total_hashes            : Safe_UInt
    transformed_hashes      : Safe_UInt
    error_message           : Optional[Safe_Str__Text]   = None
```

---

## Part 4: Route Implementation

### 4.1 Updated Routes__Text_Transformation

```python
# fast_api/routes/Routes__Text_Transformation.py

from fastapi                                                                                        import HTTPException
from osbot_fast_api.api.routes.Fast_API__Routes                                                     import Fast_API__Routes
from osbot_fast_api.api.schemas.safe_str.Safe_Str__Fast_API__Route__Tag                             import Safe_Str__Fast_API__Route__Tag
from mgraph_ai_service_semantic_text.service.text_transformation.Text__Transformation__Service      import Text__Transformation__Service
from mgraph_ai_service_semantic_text.schemas.transformation.Schema__Text__Transformation__Request   import Schema__Text__Transformation__Request
from mgraph_ai_service_semantic_text.schemas.transformation.Schema__Text__Transformation__Response  import Schema__Text__Transformation__Response
from mgraph_ai_service_semantic_text.schemas.transformation.Schema__Text__Transformation__Request__XXX_Random      import Schema__Text__Transformation__Request__XXX_Random
from mgraph_ai_service_semantic_text.schemas.transformation.Schema__Text__Transformation__Request__Hashes_Random   import Schema__Text__Transformation__Request__Hashes_Random
from mgraph_ai_service_semantic_text.schemas.transformation.Schema__Text__Transformation__Request__ABCDE_By_Size   import Schema__Text__Transformation__Request__ABCDE_By_Size
from mgraph_ai_service_semantic_text.schemas.transformation.enums.Enum__Text__Transformation__Mode  import Enum__Text__Transformation__Mode

TAG__ROUTES_TEXT_TRANSFORMATION   = 'text-transformation'
ROUTES_PATHS__TEXT_TRANSFORMATION = [f'/{TAG__ROUTES_TEXT_TRANSFORMATION}' + '/transform'        ,  # Generic endpoint
                                     f'/{TAG__ROUTES_TEXT_TRANSFORMATION}' + '/xxx-random'       ,  # Mode-specific endpoints
                                     f'/{TAG__ROUTES_TEXT_TRANSFORMATION}' + '/hashes-random'    ,
                                     f'/{TAG__ROUTES_TEXT_TRANSFORMATION}' + '/abcde-by-size'    ]

class Routes__Text_Transformation(Fast_API__Routes):
    tag         : Safe_Str__Fast_API__Route__Tag    =  TAG__ROUTES_TEXT_TRANSFORMATION
    service     : Text__Transformation__Service

    # ========================================
    # Generic Endpoint (Existing - Keep)
    # ========================================
    
    def transform(self,                                                             # Generic transformation endpoint
                  request: Schema__Text__Transformation__Request                    # Full transformation request with mode
             ) -> Schema__Text__Transformation__Response:                           # Transformation response
        try:
            response = self.service.transform(request)

            if not response.success:
                raise HTTPException(status_code=500, detail=response.error_message)

            return response

        except HTTPException:
            raise

        except Exception as e:
            raise HTTPException(status_code=500, detail=f"Transformation failed: {str(e)}")

    # ========================================
    # Mode-Specific Endpoints (New)
    # ========================================
    
    def transform__xxx_random(self,                                                 # XXX-Random transformation endpoint
                              request: Schema__Text__Transformation__Request__XXX_Random  # XXX-Random specific request
                         ) -> Schema__Text__Transformation__Response:               # Transformation response
        full_request = Schema__Text__Transformation__Request(
            hash_mapping            = request.hash_mapping                          ,
            transformation_mode     = Enum__Text__Transformation__Mode.XXX_RANDOM   ,
            randomness_percentage   = request.randomness_percentage                 )
        
        return self.transform(full_request)
    
    def transform__hashes_random(self,                                              # Hashes-Random transformation endpoint
                                 request: Schema__Text__Transformation__Request__Hashes_Random  # Hashes-Random specific request
                            ) -> Schema__Text__Transformation__Response:            # Transformation response
        full_request = Schema__Text__Transformation__Request(
            hash_mapping            = request.hash_mapping                          ,
            transformation_mode     = Enum__Text__Transformation__Mode.HASHES_RANDOM,
            randomness_percentage   = request.randomness_percentage                 )
        
        return self.transform(full_request)
    
    def transform__abcde_by_size(self,                                              # ABCDE-By-Size transformation endpoint
                                 request: Schema__Text__Transformation__Request__ABCDE_By_Size  # ABCDE-By-Size specific request
                            ) -> Schema__Text__Transformation__Response:            # Transformation response
        # Note: num_groups parameter would need to be passed to the engine
        # Current implementation doesn't expose this parameter - see recommendations
        
        full_request = Schema__Text__Transformation__Request(
            hash_mapping            = request.hash_mapping                          ,
            transformation_mode     = Enum__Text__Transformation__Mode.ABCDE_BY_SIZE,
            randomness_percentage   = request.randomness_percentage                 )
        
        return self.transform(full_request)

    def setup_routes(self):                                                         # Register all route handlers
        self.add_route_post(self.transform             )                           # Generic endpoint
        self.add_route_post(self.transform__xxx_random )                           # Mode-specific endpoints
        self.add_route_post(self.transform__hashes_random)
        self.add_route_post(self.transform__abcde_by_size)
```

### 4.2 URL Path Configuration

**Automatic Path Generation:**

The `add_route_post()` method will generate paths from method names:
- `transform` → `/text-transformation/transform`
- `transform__xxx_random` → `/text-transformation/xxx-random`
- `transform__hashes_random` → `/text-transformation/hashes-random`
- `transform__abcde_by_size` → `/text-transformation/abcde-by-size`

**Path Pattern:** Double underscore (`__`) in method name becomes hyphen (`-`) in URL

---

## Part 5: Enhanced Features (Optional)

### 5.1 Support for num_groups Parameter (ABCDE Mode)

**Current Issue:**
The `num_groups` parameter in `Schema__Text__Transformation__Request__ABCDE_By_Size` cannot currently be passed through to the engine because `Text__Transformation__Service` doesn't support per-request configuration.

**Option A: Simple Approach (Ignore for v1)**
- Accept `num_groups` in schema but don't use it
- Always use default value (5)
- Document limitation
- Defer to future enhancement

**Option B: Enhanced Approach (Recommended for v2)**
- Add `engine_config` parameter to `Schema__Text__Transformation__Request`
- Pass configuration through to engines
- Engines can use or ignore config based on their needs

```python
# Future enhancement (v2):
class Schema__Text__Transformation__Request(Type_Safe):
    hash_mapping            : Dict[Safe_Str__Hash, str]
    transformation_mode     : Enum__Text__Transformation__Mode
    randomness_percentage   : Safe_Float                       = 0.5
    engine_config           : Optional[Dict[str, Any]]         = None              # Engine-specific configuration

# In ABCDE endpoint:
full_request = Schema__Text__Transformation__Request(
    hash_mapping            = request.hash_mapping                          ,
    transformation_mode     = Enum__Text__Transformation__Mode.ABCDE_BY_SIZE,
    randomness_percentage   = request.randomness_percentage                 ,
    engine_config           = {'num_groups': int(request.num_groups)}       )
```

**Recommendation:** Use Option A for initial implementation, plan Option B for future.

### 5.2 Response Enhancement Options

**Option: Add Statistics Endpoints**

```python
# Future consideration:
def transform__xxx_random__with_stats(self, request) -> Schema__Text__Transformation__Response__With_Stats:
    # Return response plus detailed statistics
    # - Which hashes were selected
    # - Original vs transformed lengths
    # - Character distribution
```

**Defer to future needs** - current response schema is sufficient.

---

## Part 6: Testing Strategy

### 6.1 Test File Structure

```
tests/unit/fast_api/routes/
└── test__Routes__Text_Transformation.py
    ├── Existing tests for /transform
    └── New tests for mode-specific endpoints
```

### 6.2 Required Tests Per Endpoint

**Each mode-specific endpoint needs:**

```python
# Example for xxx-random endpoint:

def test__transform__xxx_random__init__():                                         # Verify Type_Safe inheritance
    with Routes__Text_Transformation() as _:
        assert _.transform__xxx_random
        
def test__transform__xxx_random__basic():                                         # Basic transformation test
    with Routes__Text_Transformation() as _:
        _.setup()
        request = Schema__Text__Transformation__Request__XXX_Random(
            hash_mapping={"abc": "Hello World"},
            randomness_percentage=0.5
        )
        response = _.transform__xxx_random(request)
        
        assert response.success is True
        assert response.transformation_mode == Enum__Text__Transformation__Mode.XXX_RANDOM
        assert response.total_hashes == 1
        
def test__transform__xxx_random__empty_mapping():                                 # Edge case: empty input
    with Routes__Text_Transformation() as _:
        _.setup()
        request = Schema__Text__Transformation__Request__XXX_Random(
            hash_mapping={},
            randomness_percentage=0.5
        )
        response = _.transform__xxx_random(request)
        
        assert response.success is True
        assert response.total_hashes == 0
        
def test__transform__xxx_random__full_randomness():                               # Edge case: 100% transformation
    with Routes__Text_Transformation() as _:
        _.setup()
        request = Schema__Text__Transformation__Request__XXX_Random(
            hash_mapping={"abc": "Hello", "def": "World"},
            randomness_percentage=1.0
        )
        response = _.transform__xxx_random(request)
        
        assert response.success is True
        assert response.transformed_hashes == 2                                    # All should be transformed
        
def test__transform__xxx_random__zero_randomness():                               # Edge case: 0% transformation
    with Routes__Text_Transformation() as _:
        _.setup()
        request = Schema__Text__Transformation__Request__XXX_Random(
            hash_mapping={"abc": "Hello"},
            randomness_percentage=0.0
        )
        response = _.transform__xxx_random(request)
        
        assert response.success is True
        # Note: Current implementation selects at least 1 hash, so transformed_hashes might be 1

def test__transform__xxx_random__delegates_to_transform():                        # Verify delegation
    # Use mock to verify that transform() is called with correct mode
```

**Repeat pattern for:**
- `test__transform__hashes_random__*`
- `test__transform__abcde_by_size__*`

### 6.3 Integration Tests

```python
# tests/integration/test__Text_Transformation__API.py

def test__api__xxx_random__endpoint():                                            # Test via HTTP
    client = TestClient(app)
    response = client.post("/text-transformation/xxx-random", json={
        "hash_mapping": {"abc": "Hello World"},
        "randomness_percentage": 0.5
    })
    
    assert response.status_code == 200
    data = response.json()
    assert data["success"] is True
    assert data["transformation_mode"] == "xxx-random"
```

### 6.4 OpenAPI Schema Tests

```python
def test__openapi__mode_specific_endpoints_present():                            # Verify endpoints in OpenAPI spec
    # Get OpenAPI JSON
    # Verify all 4 endpoints present
    # Verify correct schemas referenced
```

---

## Part 7: Documentation Requirements

### 7.1 OpenAPI Documentation

**Each endpoint needs:**

```python
def transform__xxx_random(self,
                          request: Schema__Text__Transformation__Request__XXX_Random
                     ) -> Schema__Text__Transformation__Response:
    """
    XXX-Random Transformation
    
    Randomly masks approximately 50% of text nodes with 'x' characters while 
    preserving structure (whitespace and punctuation).
    
    **Transformation Details:**
    - Replaces alphanumeric characters with 'x'
    - Preserves whitespace (word boundaries remain visible)
    - Preserves punctuation (structure remains readable)
    - Random selection based on randomness_percentage
    
    **Use Cases:**
    - Privacy-aware text testing
    - Semantic structure analysis
    - Visual layout testing without content
    
    **Example:**
    ```
    Input:  "Hello, World!"
    Output: "xxxxx, xxxxx!"
    ```
    """
```

**Add to README.md:**

```markdown
## API Endpoints

### Generic Transformation
`POST /text-transformation/transform`

Transform text using any supported mode.

### Mode-Specific Endpoints (Convenience)

#### XXX-Random
`POST /text-transformation/xxx-random`

Randomly masks text with 'x' characters.

#### Hashes-Random  
`POST /text-transformation/hashes-random`

Randomly replaces text with hash values.

#### ABCDE-By-Size
`POST /text-transformation/abcde-by-size`

Groups text by length and replaces with letters (a, b, c, d, e).

### Request Examples

**XXX-Random:**
```json
{
  "hash_mapping": {
    "abc123": "Hello World",
    "def456": "Test message"
  },
  "randomness_percentage": 0.5
}
```

**Response (all endpoints):**
```json
{
  "transformed_mapping": {
    "abc123": "xxxxx xxxxx",
    "def456": "Test message"
  },
  "transformation_mode": "xxx-random",
  "success": true,
  "total_hashes": 2,
  "transformed_hashes": 1,
  "error_message": null
}
```
```

### 7.2 Code Documentation

**Inline comments for each new method:**
- Purpose of endpoint
- How it differs from generic endpoint
- When to use it vs generic endpoint

---

## Part 8: Implementation Checklist

### Phase 1: Core Implementation

**Schemas:**
- [ ] Create `Schema__Text__Transformation__Request__XXX_Random`
- [ ] Create `Schema__Text__Transformation__Request__Hashes_Random`
- [ ] Create `Schema__Text__Transformation__Request__ABCDE_By_Size`
- [ ] Update schema `__init__.py` files

**Routes:**
- [ ] Add `transform__xxx_random()` method
- [ ] Add `transform__hashes_random()` method
- [ ] Add `transform__abcde_by_size()` method
- [ ] Update `setup_routes()` to register new endpoints
- [ ] Update `ROUTES_PATHS__TEXT_TRANSFORMATION` constant

**Configuration:**
- [ ] Verify path generation from method names
- [ ] Test OpenAPI spec generation

### Phase 2: Testing

**Unit Tests:**
- [ ] Test suite for `transform__xxx_random`
- [ ] Test suite for `transform__hashes_random`
- [ ] Test suite for `transform__abcde_by_size`
- [ ] Test delegation to generic `transform()` method
- [ ] Test error handling for each endpoint

**Integration Tests:**
- [ ] HTTP endpoint tests for each mode
- [ ] OpenAPI schema validation tests
- [ ] Response format consistency tests

**Edge Cases:**
- [ ] Empty hash mapping
- [ ] 0% randomness
- [ ] 100% randomness
- [ ] Single hash
- [ ] Large hash mappings

### Phase 3: Documentation

**Code Documentation:**
- [ ] Inline comments for all new methods
- [ ] Docstrings for OpenAPI (if used)

**External Documentation:**
- [ ] Update README with new endpoints
- [ ] Add usage examples for each mode
- [ ] Document when to use mode-specific vs generic endpoint

**API Documentation:**
- [ ] Verify OpenAPI spec shows all 4 endpoints
- [ ] Verify schemas are correctly linked
- [ ] Add descriptions for each endpoint

### Phase 4: Validation

**Manual Testing:**
- [ ] Test each endpoint via Swagger UI
- [ ] Verify request/response in API docs
- [ ] Test error scenarios

**Deployment:**
- [ ] Deploy to dev environment
- [ ] Smoke test all endpoints
- [ ] Verify backward compatibility

---

## Part 9: Success Criteria

### Functional Requirements ✅

- ✅ All three mode-specific endpoints work correctly
- ✅ Generic `/transform` endpoint remains unchanged
- ✅ All endpoints return consistent response format
- ✅ Error handling works for all endpoints
- ✅ Full backward compatibility maintained

### Non-Functional Requirements ✅

- ✅ Code follows Type_Safe patterns
- ✅ No code duplication (thin wrappers)
- ✅ No new business logic in routes
- ✅ Comprehensive inline comments
- ✅ >90% test coverage for new code

### Testing Requirements ✅

- ✅ Unit tests for all new methods
- ✅ Integration tests via HTTP
- ✅ Edge case coverage
- ✅ OpenAPI schema validation

### Documentation Requirements ✅

- ✅ OpenAPI spec includes all endpoints
- ✅ README updated with examples
- ✅ Inline documentation complete

---

## Part 10: Future Enhancements

### After Initial Implementation

**Phase 2 Enhancements:**

1. **Engine Configuration Support**
   - Add `engine_config` parameter to base request schema
   - Allow passing `num_groups` to ABCDE engine
   - Enable per-request engine customization

2. **Batch Transformation Endpoint**
   ```python
   POST /text-transformation/batch
   # Accept multiple transformation requests
   # Return array of responses
   ```

3. **Statistics Endpoints**
   ```python
   POST /text-transformation/xxx-random/with-stats
   # Return detailed transformation statistics
   ```

4. **Dry-Run Mode**
   ```python
   # Add dry_run parameter to preview transformations
   # Returns what would be transformed without applying changes
   ```

5. **Transformation Comparison**
   ```python
   POST /text-transformation/compare
   # Apply multiple modes to same input
   # Return side-by-side comparison
   ```

---

## Part 11: Reference Information

### Key Files to Create

**Schemas:**
- `mgraph_ai_service_semantic_text/schemas/transformation/Schema__Text__Transformation__Request__XXX_Random.py`
- `mgraph_ai_service_semantic_text/schemas/transformation/Schema__Text__Transformation__Request__Hashes_Random.py`
- `mgraph_ai_service_semantic_text/schemas/transformation/Schema__Text__Transformation__Request__ABCDE_By_Size.py`

**Routes (Update):**
- `mgraph_ai_service_semantic_text/fast_api/routes/Routes__Text_Transformation.py`

**Tests:**
- `tests/unit/fast_api/routes/test__Routes__Text_Transformation.py` (update)
- `tests/integration/test__Text_Transformation__API.py` (create/update)

### Files to Update

**Existing Files:**
- `mgraph_ai_service_semantic_text/fast_api/routes/Routes__Text_Transformation.py` (add new methods)
- Update schema `__init__.py` for new imports

### No Changes Needed

**These remain unchanged:**
- `Text__Transformation__Service.py` (no changes to business logic)
- All engine implementations
- `Schema__Text__Transformation__Request.py` (original schema)
- `Schema__Text__Transformation__Response.py`

---

## Part 12: Risk Assessment

### Low Risk ✅

- No business logic changes
- Thin wrappers only
- Full backward compatibility
- Easy to test
- Easy to rollback

### Potential Issues

**Issue 1: num_groups Parameter**
- **Risk:** ABCDE endpoint accepts but ignores `num_groups`
- **Mitigation:** Document limitation, plan future enhancement
- **Impact:** Low - default value works for most cases

**Issue 2: URL Path Conflicts**
- **Risk:** Method name to URL conversion conflicts
- **Mitigation:** Test path generation, verify in OpenAPI
- **Impact:** Low - standard naming convention used

**Issue 3: Test Coverage Gap**
- **Risk:** Missing edge cases in testing
- **Mitigation:** Comprehensive test checklist
- **Impact:** Medium - catch with thorough review

### Migration Strategy

**No migration needed** - purely additive change:
1. Deploy new version
2. Existing clients continue using `/transform`
3. New clients can use mode-specific endpoints
4. No breaking changes

---

## Conclusion

This enhancement provides significant value with minimal risk:

**Benefits:**
- ✅ Improved testability
- ✅ Better developer experience  
- ✅ Enhanced API discoverability
- ✅ Clearer documentation
- ✅ No breaking changes

**Implementation Effort:**
- **Low complexity** - thin wrappers only
- **Estimated time:** 4-6 hours (coding + testing + docs)
- **Low risk** - no business logic changes

**Recommendation:** **APPROVE** and proceed with implementation.

The mode-specific endpoints are a natural evolution of the API that will significantly improve usability while maintaining the architectural integrity of the service.